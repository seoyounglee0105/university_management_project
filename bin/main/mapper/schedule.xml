<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.green.university.repository.interfaces.ScheuleRepository">




<insert id="insertSchoeduleFormDto">
INSERT INTO schedule_tb
(staff_id, start_day, end_day, title, content)
VALUES
(#{staffId}, #{startDay}, #{endDay}, #{title}, #{content});
</insert>

<!-- 전체 조회 -->
<select id="selectSchodule" resultType="com.green.university.repository.model.Schedule">
SELECT id, staff_id, date_format(start_day,'%m-%d') AS start_day, date_format(end_day,'%m-%d') AS  end_day,
title, content, YEAR(start_day) as year, MONTH(end_day) AS month
FROM schedule_tb
ORDER BY start_day;
</select>

<select id="selectScheduleById" resultType="com.green.university.repository.model.Schedule">
SELECT * FROM schedule_tb WHERE id = #{id};
</select>

<!-- 월마다 일정 몇개인지 조회 -->
<select id="selectSchoduleMouth" resultType="com.green.university.dto.ScheduleDto">
SELECT mouth, count(mouth) AS sum
FROM schedule_tb
GROUP BY mouth
HAVING COUNT(mouth) > 1;
</select>


<update id="updateSchoeduleFormDtoBycontent">
UPDATE schedule_tb 
SET title = #{title}, content = #{content} 
WHERE id = #{id};
</update>

<delete id="deleteSchoeduleFormDtoByStaffIdAndId">
DELETE FROM schedule_tb where id = #{id};
</delete>



</mapper>